<script>
    function exportTableToCSV(filename) {
      var csv = [];
      var rows = document.querySelectorAll("#data-table tr");
  
      for (var i = 0; i < rows.length; i++) {
        var row = [],
          cols = rows[i].querySelectorAll("td, th");
  
        for (var j = 0; j < cols.length; j++) {
          row.push('"' + cols[j].innerText.replace(/"/g, '""') + '"'); // Escape quotes
        }
  
        csv.push(row.join(","));
      }
  
      // Download CSV
      downloadCSV(csv.join("\n"), filename);
    }
  
    function downloadCSV(csv, filename) {
      var csvFile;
      var downloadLink;
  
      // Create a CSV file
      csvFile = new Blob([csv], { type: "text/csv" });
  
      // Create a download link
      downloadLink = document.createElement("a");
      downloadLink.download = filename;
      downloadLink.href = window.URL.createObjectURL(csvFile);
  
      // Hide download link
      downloadLink.style.display = "none";
      document.body.appendChild(downloadLink);
  
      // Click the download link
      downloadLink.click();
    }
  
    function exportTableToExcel(filename) {
      var table = document.getElementById('data-table');
      var workbook = XLSX.utils.table_to_book(table, { sheet: "Sheet1" });
      XLSX.writeFile(workbook, filename);
    }
  
    function exportTableToExcel(filename) {
          var table = document.getElementById('data-table');
          var workbook = XLSX.utils.table_to_book(table, { sheet: "Sheet1" });
          XLSX.writeFile(workbook, filename);
        }
  
        async function exportTableToPDF(filename) {
    const { jsPDF } = window.jspdf;  // Access jsPDF from the window object
    const doc = new jsPDF('landscape', 'pt', 'a4');  // Create a new jsPDF document in landscape mode
  
    const table = document.getElementById("data-table");
  
    // Extract Table Data
    var rows = table.querySelectorAll("tr");
    var data = [];
  
    rows.forEach((row) => {
      var cols = row.querySelectorAll("td, th");
      var rowData = [];
      cols.forEach(col => {
        rowData.push(col.innerText.trim());
      });
      data.push(rowData);
    });
  
    // Calculate equal width for each column
    const totalColumns = data[0].length;  // Assuming the first row contains the header
    const pageWidth = doc.internal.pageSize.getWidth();
    const margin = 40;  // Left and right margin combined
    const usableWidth = pageWidth - margin;
    const equalColumnWidth = usableWidth / totalColumns;
  
    // Setup autoTable with equal column widths
    doc.autoTable({
      head: [data[0]],  // Header row
      body: data.slice(1),  // Body rows
      startY: 20,
      theme: 'striped',  // Table theme: striped, grid, plain
      headStyles: { fillColor: [22, 160, 133], textColor: 255 },  // Header styling
      bodyStyles: { fillColor: [242, 242, 242] },  // Body styling
      alternateRowStyles: { fillColor: [255, 255, 255] },  // Alternating row styles
      styles: {
        fontSize: 8,  // Font size
        overflow: 'linebreak',  // Handling overflow content
        cellPadding: 3,  // Cell padding
        valign: 'middle',  // Vertical alignment
        halign: 'center',  // Horizontal alignment
        minCellHeight: 20  // Minimum cell height
      },
      columnStyles: {
        0: { cellWidth: equalColumnWidth },  // Set equal width for each column
        1: { cellWidth: equalColumnWidth },
        2: { cellWidth: equalColumnWidth },
        // Repeat for all columns
        // or use dynamic mapping for multiple columns:
        ...Array.from({ length: totalColumns }, (_, i) => ({ [i]: { cellWidth: equalColumnWidth } })).reduce((a, b) => Object.assign(a, b), {})
      },
      didDrawPage: function (data) {
        // Optional: Draw header/footer on each page
        doc.text('Student Data Export', data.settings.margin.left, 10);
      },
    });
  
    // Save the PDF
    doc.save(filename);
  }
  
  function printTable() {
    // Extract the table HTML
    var table = document.getElementById("data-table");
    var tableHTML = table.outerHTML;
  
    // Create a new window for printing
    var printWindow = window.open('', '', 'height=800,width=1200');
  
    // Write the table HTML to the new window
    printWindow.document.write('<html><head><title>Print Table</title>');
    printWindow.document.write('<style>');  // Add styles for the print layout
    printWindow.document.write('table { width: 100%; border-collapse: collapse; }');
    printWindow.document.write('th, td { border: 1px solid black; padding: 8px; text-align: left; }');
    printWindow.document.write('th { background-color: #f2f2f2; }');
    printWindow.document.write('@media print { table { page-break-inside: auto; } tr { page-break-inside: avoid; page-break-after: auto; } }');
    printWindow.document.write('</style>');
    printWindow.document.write('</head><body>');
    printWindow.document.write('<h1>Student Data</h1>');  // Optional title
    printWindow.document.write(tableHTML);  // Insert the table HTML
    printWindow.document.write('</body></html>');
  
    // Close the document and trigger print dialog
    printWindow.document.close();
    printWindow.focus();
    printWindow.print();
  }
  
  
  
  
  </script>
  
  <!-- Export Buttons -->
<button onclick="exportTableToCSV('table-data.csv')">Export to CSV</button>
<button onclick="exportTableToExcel('table-data.xlsx')">Export to Excel</button>
<button onclick="exportTableToPDF('table-data.pdf')">Export to PDF</button> <!-- New PDF Export Button -->
<button onclick="printTable()">Print Table</button>


<!-- Include jsPDF and jsPDF AutoTable libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>


<!-- JavaScript Libraries and Scripts -->
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>